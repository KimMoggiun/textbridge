<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Feb 9, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #2104 | 10:32 PM | ğŸŸ£ | App-bridge Dart-Python consistency validation completed successfully | ~447 |
| #2102 | " | ğŸŸ£ | App-bridge comprehensive test suite initiated in background | ~384 |
| #2101 | 10:31 PM | ğŸ”„ | Removed unused ime_in_korean variable from test_app_bridge.py | ~126 |
| #2100 | " | ğŸ”´ | Fixed IME reset after Korean text using explicit protocol sequence | ~387 |
| #2099 | " | ğŸ”´ | Added IME reset logic to prevent Korean state carryover between tests | ~368 |
| #2098 | " | ğŸ”µ | Examined test_app_bridge.py run_bridge_tests function implementation | ~363 |
| #2095 | 10:21 PM | ğŸŸ£ | Dart-Python bridge test validation completed with 100% pass rate | ~474 |
| #2094 | " | ğŸŸ£ | Initiated complete app-firmware bridge test suite in background | ~359 |
| #2093 | " | ğŸ”µ | Test Case Filtering Logic for Platform-Specific Korean Tests | ~413 |
| #2092 | " | ğŸ”´ | Fixed test case filtering logic for macOS Korean text tests | ~351 |
| #2091 | 10:20 PM | ğŸ”µ | Attempted test_app_bridge.py execution to verify available test cases | ~304 |
| #2090 | " | ğŸ”´ | Fixed test_app_bridge.py to filter Windows-specific test cases on macOS | ~321 |
| #2088 | 10:17 PM | ğŸ”µ | Dart-Python keycode parity achieved after trailing toggle removal | ~346 |
| #2087 | " | ğŸ”´ | Removed trailing toggle key from hangul_to_keycodes function | ~333 |
| #2086 | " | ğŸ”„ | Streamlined test_phase3_protocol.py for silent background execution | ~373 |
| #2085 | " | ğŸ”µ | Confirmed Dart-Python trailing toggle keycode discrepancy | ~385 |
| #2084 | " | ğŸŸ£ | Dart keycode export test generated JSON with 12 test cases | ~321 |
| #2083 | 10:16 PM | ğŸŸ£ | Committed simplified test infrastructure with Claude Code terminal HID verification | ~485 |
| #2081 | " | ğŸ”µ | Project-wide refactoring reduced codebase by 413 lines | ~388 |
| #2075 | 10:15 PM | ğŸŸ£ | Phase 5 comprehensive Korean text test suite completed successfully | ~414 |
| #2068 | 10:12 PM | ğŸŸ£ | Validated Korean text with punctuation via BLE HID injection | ~307 |
| #2064 | 10:10 PM | ğŸŸ£ | Phase 5 pure Korean text group transmission completed in background | ~362 |
| #2062 | 10:09 PM | ğŸŸ£ | Background Korean text transmission completed successfully | ~343 |
| #2060 | " | ğŸŸ£ | Background execution of Korean text transmission initiated | ~346 |
| #2056 | 9:58 PM | ğŸŸ£ | Phase 5 hangul test suite validated with minimal output format | ~364 |
| #2054 | 9:56 PM | âœ… | Updated CLAUDE.md with concrete test command examples and clarified validation workflow | ~382 |
| #2053 | " | âœ… | Simplified CLAUDE.md documentation to reflect minimized test scripts | ~399 |
| #2052 | 9:55 PM | âœ… | Removed pynput dependency and VIA pairing table from documentation | ~324 |
| #2051 | " | ğŸ”„ | Simplified test_phase5_hangul.py for Claude Code terminal verification | ~394 |
| #2049 | 9:53 PM | âœ… | Added Minimal Status Messages to Main Script | ~326 |
| #2048 | 9:51 PM | ğŸ”´ | test_phase3_protocol.py executed successfully in silent mode | ~294 |
| #2047 | 9:50 PM | ğŸ”„ | Silenced scan output in test_phase3_protocol.py | ~266 |
| #2046 | " | ğŸ”„ | Simplified via_start_pairing function removing verbose output | ~344 |
| #2045 | " | ğŸ”„ | Simplified send_text method by removing all print statements | ~335 |
| #2044 | " | ğŸ”„ | Silenced debug output in TextBridgeClient protocol methods | ~352 |
| #2043 | " | ğŸ”„ | Silenced BLE Response Logging in TextBridgeClient | ~317 |
| #2042 | 9:49 PM | ğŸ”„ | Aggressively simplified test_phase3_protocol.py main function | ~348 |
| #2041 | " | ğŸ”µ | test_phase3_protocol.py simplified to single-purpose text sender | ~320 |
| #2039 | 9:47 PM | ğŸ”„ | Unified chunking logic in test_phase5_hangul.py using split_chunks | ~316 |
| #2038 | " | ğŸ”„ | Added split_chunks import to Phase 5 hangul tests | ~274 |
| #2037 | " | ğŸ”µ | Examined hangul_to_keycodes implementation and test function structure | ~341 |
| #2036 | " | âœ… | Documented macOS input source requirements for Korean text testing | ~308 |
| #2035 | 9:44 PM | ğŸŸ£ | Korean hangul E2E testing validated with 12/12 test cases passing | ~410 |
| #2034 | " | ğŸ”µ | Confirmed Dart-Python trailing toggle keycode discrepancy | ~401 |
| #2033 | " | ğŸ”„ | Simplified test_app_bridge.py removing CLI options and hardcoding macOS configuration | ~390 |
| #2032 | 9:43 PM | ğŸ”„ | Removed unused CLI arguments from test_app_bridge.py | ~303 |
| #2031 | " | ğŸ”„ | Removed HIDVerifier dependency from app bridge tests | ~321 |
| #2030 | " | ğŸ”„ | Removed HIDVerifier import from test_app_bridge.py | ~278 |
| #2029 | " | ğŸ”„ | Simplified test_phase5_hangul.py by removing pynput verification | ~351 |
| #2028 | " | ğŸ”„ | Removed pynput HID Verification from test_phase5_hangul.py | ~343 |
</claude-mem-context>

# TextBridge Tools

Keychron B6 Pro (nRF52840) íŒì›¨ì–´ ë¹Œë“œ, í”Œë˜ì‹œ, í…ŒìŠ¤íŠ¸ ë„êµ¬ ëª¨ìŒ.

## ì˜ì¡´ì„±

```bash
pip install hidapi bleak
```

- `hidapi`: USB Raw HID í†µì‹  (enter_dfu.py, tb_pair.py)
- `bleak`: BLE GATT í†µì‹  (ëª¨ë“  í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸)

ëª¨ë“  BLE í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ì— VIA í˜ì–´ë§(0xFE)ì´ ë‚´ì¥ë˜ì–´ ìˆë‹¤.

## ë¹Œë“œ

```bash
source ~/.zmk_env/bin/activate && \
export ZEPHYR_SDK_INSTALL_DIR=~/.zephyr-sdk-0.16.3 && \
cd ~/project/textbridge/zmk_keychron/app && \
west build --pristine -b keychron -- -DSHIELD=keychron_b6_us
```

ì¶œë ¥: `build/zephyr/zmk.uf2` (FLASH 25%, SRAM 33%)

`--pristine` ìƒëµí•˜ë©´ ì¦ë¶„ ë¹Œë“œ (ë³€ê²½ íŒŒì¼ë§Œ ì¬ì»´íŒŒì¼).

## DFU ì§„ì… + í”Œë˜ì‹œ

```bash
python3 enter_dfu.py && sleep 3 && cp ~/project/textbridge/zmk_keychron/app/build/zephyr/zmk.uf2 /Volumes/NRF52BOOT/
```

ìˆ˜ë™ DFU: í‚¤ë³´ë“œ ESC ëˆ„ë¥¸ ì±„ USB ì—°ê²°.

## í…ìŠ¤íŠ¸ ì „ì†¡ (test_phase3_protocol.py)

VIA í˜ì–´ë§ â†’ BLE ìŠ¤ìº” â†’ ì—°ê²° â†’ í‚¤ì½”ë“œ ì „ì†¡ â†’ Enter. ëª¨ë‘ ìë™. macOS(Ctrl+Space í† ê¸€) ê³ ì •.

```bash
python3 test_phase3_protocol.py --text "hello"
python3 test_phase3_protocol.py --text "Hello ì•ˆë…• World"
```

ì¶œë ¥:

```
pairing... ok
scanning... 7B2890F5-B71F-CC2C-0CC1-C9A378436B0B
sending... ok
```

## í•œê¸€ ì „ì†¡ í…ŒìŠ¤íŠ¸ (test_phase5_hangul.py)

ì‚¬ì „ ì •ì˜ëœ í•œê¸€ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ìˆœì„œëŒ€ë¡œ ì „ì†¡. ê° í…ìŠ¤íŠ¸ë§ˆë‹¤ Enter í¬í•¨.

```bash
python3 test_phase5_hangul.py --test pure        # ìˆœìˆ˜ í•œê¸€ (ì•ˆë…•í•˜ì„¸ìš”, ëŒ€í•œë¯¼êµ­, í”„ë¡œê·¸ë˜ë°)
python3 test_phase5_hangul.py --test mixed       # í•œì˜ í˜¼í•©
python3 test_phase5_hangul.py --test complex     # ìŒììŒ/ê²¹ë°›ì¹¨ (ê¹Œë‹­ì—†ì´, ì™•ê´€, ê°’ì‹¼, ì½ë‹¤, ì•‰ë‹¤)
python3 test_phase5_hangul.py --test all         # ì „ì²´
```

ì¶œë ¥:

```
pairing... ok
scanning... 7B2890F5-B71F-CC2C-0CC1-C9A378436B0B
ì•ˆë…•í•˜ì„¸ìš”... ok
ëŒ€í•œë¯¼êµ­... ok
```

## Dart-Python í‚¤ì½”ë“œ ë¹„êµ (test_app_bridge.py)

```bash
python3 test_app_bridge.py --compare all         # ì˜¤í”„ë¼ì¸ ë¹„êµ (BLE ë¶ˆí•„ìš”)
python3 test_app_bridge.py --test all            # BLE ì „ì†¡ í…ŒìŠ¤íŠ¸
```

## ê¸°íƒ€ ë„êµ¬

| ë„êµ¬ | ì„¤ëª… |
|------|------|
| `enter_dfu.py` | VIA Raw HIDë¡œ DFU ë¶€íŠ¸ë¡œë” ì§„ì… |
| `tb_pair.py` | VIA Raw HIDë¡œ BLE ê´‘ê³  ì‹œì‘ (ë””ë²„ê¹…ìš©) |
| `test_phase2_ble.py` | BLE GATT ì—°ê²°/ì„œë¹„ìŠ¤/íŠ¹ì„± í…ŒìŠ¤íŠ¸ |

## HID ì¶œë ¥ ê²€ì¦ ë°©ë²• (Claude Code í„°ë¯¸ë„ í™œìš©)

### ê°œìš”

í‚¤ë³´ë“œ íŒì›¨ì–´ê°€ USB HIDë¡œ ì£¼ì…í•˜ëŠ” í…ìŠ¤íŠ¸ê°€ ì˜¬ë°”ë¥¸ì§€ ê²€ì¦í•˜ëŠ” ë°©ë²•.
pynput(macOS Accessibility ê¶Œí•œ í•„ìš”)ì´ë‚˜ clipboard ì¡°ì‘ ì—†ì´, **Claude Code ìì²´ë¥¼ ê²€ì¦ê¸°**ë¡œ ì‚¬ìš©í•œë‹¤.

### ë™ì‘ ì›ë¦¬

TextBridge í‚¤ë³´ë“œëŠ” USB HID í‚¤ë³´ë“œë‹¤. í‚¤ì½”ë“œë¥¼ ì£¼ì…í•˜ë©´ macOSê°€ **í˜„ì¬ ì»¤ì„œ í¬ì»¤ìŠ¤ê°€ ìˆëŠ” ì•±**ì— í‚¤ ì…ë ¥ì„ ì „ë‹¬í•œë‹¤.

```
Python ìŠ¤í¬ë¦½íŠ¸ â†’(BLE)â†’ í‚¤ë³´ë“œ íŒì›¨ì–´ â†’(USB HID)â†’ macOS â†’(í‚¤ ì…ë ¥)â†’ í¬ì»¤ìŠ¤ëœ ì•±
```

ì‚¬ìš©ìê°€ **Claude Code í„°ë¯¸ë„ ì…ë ¥ì°½ì— ì»¤ì„œë¥¼ ë‘” ìƒíƒœ**ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´,
HID ì£¼ì…ëœ ë¬¸ìë“¤ì´ Claude Code ì…ë ¥ì°½ì— íƒ€ì´í•‘ëœë‹¤.
í…ìŠ¤íŠ¸ ëì— **Enter í‚¤ì½”ë“œ(HID 0x28)**ë¥¼ ë³´ë‚´ë©´, Claude Codeì— **ì‚¬ìš©ì ë©”ì‹œì§€ë¡œ ì œì¶œ**ëœë‹¤.

### Claude Codeê°€ ìˆ˜í–‰í•  ê²€ì¦ ì ˆì°¨

1. **ì˜ˆìƒ í…ìŠ¤íŠ¸ë¥¼ ê¸°ì–µí•œë‹¤** â€” Python ìŠ¤í¬ë¦½íŠ¸ê°€ ë³´ë‚¼ í…ìŠ¤íŠ¸ë¥¼ ë¯¸ë¦¬ ì•Œê³  ìˆì–´ì•¼ í•œë‹¤
2. **Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰í•œë‹¤** â€” Bash ë„êµ¬ì˜ `run_in_background` ì‚¬ìš©
   ```bash
   # ë‹¨ì¼ í…ìŠ¤íŠ¸ ê²€ì¦
   python3 test_phase3_protocol.py --text "hello"
   # í•œê¸€ ê·¸ë£¹ ê²€ì¦
   python3 test_phase5_hangul.py --test pure
   ```
   - ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ëŠ” í…ìŠ¤íŠ¸ ëì— Enter(0x28)ë¥¼ ìë™ ì¶”ê°€í•œë‹¤
3. **ë‹¤ìŒ ì‚¬ìš©ì ë©”ì‹œì§€ë¥¼ ê¸°ë‹¤ë¦°ë‹¤** â€” HID ì£¼ì…ì´ ì™„ë£Œë˜ë©´ Enterì— ì˜í•´ ìë™ ì œì¶œëœë‹¤
   - ì´ ë©”ì‹œì§€ì˜ ë‚´ìš©ì´ ê³§ í‚¤ë³´ë“œê°€ ì‹¤ì œë¡œ ì¶œë ¥í•œ í…ìŠ¤íŠ¸ì´ë‹¤
4. **ìˆ˜ì‹ í•œ ë©”ì‹œì§€ vs ì˜ˆìƒ í…ìŠ¤íŠ¸ë¥¼ ë¹„êµí•œë‹¤** â€” ì¼ì¹˜í•˜ë©´ PASS, ë¶ˆì¼ì¹˜ë©´ FAIL + diff ì¶œë ¥

### ì „ì œ ì¡°ê±´

- **macOS ì…ë ¥ ì†ŒìŠ¤ê°€ ì˜ë¬¸(ABC)** ìƒíƒœì—ì„œ ì‹œì‘í•´ì•¼ í•œë‹¤. ëª¨ë“  í…ŒìŠ¤íŠ¸ëŠ” ì‹œìŠ¤í…œ ì´ˆê¸° ì…ë ¥ì´ ì˜ì–´ë¼ê³  ê°€ì •í•œë‹¤.
- í•œê¸€ í…ìŠ¤íŠ¸ê°€ ì‹œì‘ë˜ë©´ `hangul_to_keycodes`ê°€ ìë™ìœ¼ë¡œ Ctrl+Space í† ê¸€í‚¤ë¥¼ ì‚½ì…í•˜ì—¬ í•œê¸€ ì…ë ¥ìœ¼ë¡œ ì „í™˜í•œë‹¤.
- í•œê¸€ì´ ëë‚˜ë©´ ë‹¤ì‹œ í† ê¸€í‚¤ë¥¼ ì‚½ì…í•˜ì—¬ ì˜ë¬¸ìœ¼ë¡œ ë³µê·€í•œë‹¤. ë”°ë¼ì„œ ë§¤ ì „ì†¡ í›„ ì‹œìŠ¤í…œì€ ì˜ë¬¸ ìƒíƒœë¡œ ëŒì•„ì˜¨ë‹¤.
- ì‚¬ìš©ìê°€ Claude Code í„°ë¯¸ë„ ì…ë ¥ì°½ì— ì»¤ì„œ í¬ì»¤ìŠ¤ë¥¼ ìœ ì§€í•´ì•¼ í•œë‹¤
- í…ŒìŠ¤íŠ¸ ë„ì¤‘ ì‚¬ìš©ìê°€ ì§ì ‘ íƒ€ì´í•‘í•˜ë©´ ê²€ì¦ì´ ê¹¨ì§„ë‹¤

## ì£¼ì˜ì‚¬í•­

- **macOS BLE GATT ìºì‹œ**: íŒì›¨ì–´ ë¦¬í”Œë˜ì‹œ ë˜ëŠ” ë¹„ì •ìƒ BLE í•´ì œ í›„ macOSê°€ CCC ìƒíƒœë¥¼ ìºì‹±í•˜ì—¬ `tb_notify_enabled`ê°€ falseë¡œ ë‚¨ì„ ìˆ˜ ìˆìŒ. í•´ê²°: macOS Bluetooth ë„ê³  ì¼œê¸°.
- **í‚¤ë³´ë“œ ì „ì› ë¦¬ì…‹**: ë°°í„°ë¦¬ê°€ ìˆì–´ USB ì¬ì—°ê²°ë§Œìœ¼ë¡  íŒì›¨ì–´ ìƒíƒœê°€ ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ. ë’·ë©´ ì „ì› ìŠ¤ìœ„ì¹˜ OFF â†’ 5ì´ˆ â†’ ON.
- **ì‹¤í–‰ ë””ë ‰í„°ë¦¬**: ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ëŠ” `tools/` ë””ë ‰í„°ë¦¬ì—ì„œ ì‹¤í–‰. `cd tools && python3 <script>.py`

## ì‹œë¦¬ì–¼ ë¡œê·¸

```bash
screen /dev/tty.usbmodem* 115200
```
